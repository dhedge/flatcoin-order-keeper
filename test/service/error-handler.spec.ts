import { ErrorHandler } from '../../src/service/error.handler';
import { Logger } from '@nestjs/common';

describe('Error Handler', () => {
  let errorHandler: ErrorHandler;
  let logger: Logger;

  beforeEach(async () => {
    logger = new Logger();
    errorHandler = new ErrorHandler(logger);
  });

  // it('should return PriceExpired', async () => {
  //   const err =
  //     'Error: cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] ' +
  //     '(reason="execution reverted", method="estimateGas", transaction={"from":"0xE82b484C5182688a83795908C1Fa9B9417990fb6","to":"0xF82A43EDee669798b67864bb167cAbDD1C0BA6ba",' +
  //     '"value":{"type":"BigNumber","hex":"0x01"},"data":"0x3a7b1c21000000000000000000000000b74091a5c0073f64f7b5246fd73715b9730581f6000000000000000000000000000000000000000000000' +
  //     '000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000' +
  //     '00000000000000000000000001cb504e41550100000000a0010000000001000f526d0fd6fb7c063d92bfc087184e4bebe42b1b3a30de84d438848d61e4da7e1bae3d2ad838c16e1220379eacb55a7a0b8dcd7f1e952f741ae0c5b8c0' +
  //     '4491450165800e8700000000001ae101faedac5851e32b9b23b5f9411a8c2bac4aae3ed4dd7b811dd1a72ea4aa71000000000283553a0141555756000000000006f4720000002710c1c9b639e9a61367535cac5413d453674e510f8501' +
  //     '005500ca80ba6dc32e08d06f1aa886011eed1d77c77be9eb761cc10d72b7d0a2fd57a60000003229d21a80000000000eefa6bcfffffff80000000065800e870000000065800e86000000328ac823e8000000000b72aad00a9ccb7446e2d' +
  //     'd5b682d67a3ee47ac68c6575d39e83cd06443ac98e284ef6b6b188122257aaf1eb1fc5eadd55579220e5fefba40d5cab5fb1e3b6fa27b53d68c8814478f05d97fdc9b1432529dcdf39596baf01535821f50e51d58accf164b24b0704595' +
  //     'f43d3fe36994ca525d053c79d8a98eb39c87d36b52b04ac9a0a6aaea701b8064d52ab6cb71c6c822157776ae4d20bd4498006ca0b7d2abdd4aff23e80cc29e1c685177c9f541ae49b9d2f217d40f4c07c94071aebfc3d96720daf6593c08' +
  //     'd24ff4694878bc000000000000000000000000000000000000000000","accessList":null}, error={"reason":"processing response error","code":"SERVER_ERROR","body":"{\\"jsonrpc\\":\\"2' +
  //     '.0\\",\\"id\\":52402,\\"error\\":{\\"code\\":3,\\"message\\":\\"execution reverted\\",\\"data\\":\\"0xe5ece43c0000000000000000000000000000000000000000000000000000000000000000\\"}}' +
  //     '","error":{"code":3,"data":"0xe5ece43c0000000000000000000000000000000000000000000000000000000000000000"},"requestBody":"{\\"method\\":\\"eth_estimateGas\\",\\"params\\":[{\\"v' +
  //     'alue\\":\\"0x1\\",\\"from\\":\\"0xe82b484c5182688a83795908c1fa9b9417990fb6\\",\\"to\\":\\"0xf82a43edee669798b67864bb167cabdd1c0ba6ba\\",\\"data\\":\\"0x3a7b1c21000000000000000000000' +
  //     '000b74091a5c0073f64f7b5246fd73715b9730581f60000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000100000000000000000000000' +
  //     '0000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000001cb504e41550100000000a0010000000001000f526d0fd6fb7c063d92bfc087184e4bebe42b1b3a30de84d438848' +
  //     'd61e4da7e1bae3d2ad838c16e1220379eacb55a7a0b8dcd7f1e952f741ae0c5b8c04491450165800e8700000000001ae101faedac5851e32b9b23b5f9411a8c2bac4aae3ed4dd7b811dd1a72ea4aa71000000000283553a0141555756000000000' +
  //     '006f4720000002710c1c9b639e9a61367535cac5413d453674e510f8501005500ca80ba6dc32e08d06f1aa886011eed1d77c77be9eb761cc10d72b7d0a2fd57a60000003229d21a80000000000eefa6bcfffffff80000000065800e87000000006' +
  //     '5800e86000000328ac823e8000000000b72aad00a9ccb7446e2dd5b682d67a3ee47ac68c6575d39e83cd06443ac98e284ef6b6b188122257aaf1eb1fc5eadd55579220e5fefba40d5cab5fb1e3b6fa27b53d68c8814478f05d97fdc9b1432529dc' +
  //     'df39596baf01535821f50e51d58accf164b24b0704595f43d3fe36994ca525d053c79d8a98eb39c87d36b52b04ac9a0a6aaea701b8064d52ab6cb71c6c822157776ae4d20bd4498006ca0b7d2abdd4aff23e80cc29e1c685177c9f541ae49b9d2f' +
  //     '217d40f4c07c94071aebfc3d96720daf6593c08d24ff4694878bc000000000000000000000000000000000000000000\\"}],\\"id\\":52402,\\"jsonrpc\\":\\"2.0\\"}","requestMethod":"POST","url":"https:/' +
  //     '/base-goerli.g.alchemy.com/v2/2yI6KddqIgQmhjxeLuoum9SMi5YLcyOw"}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.7.2)';
  //   const result = errorHandler.getGasEstimateErrorName(err);
  //   expect(result).toBe('PriceExpired');
  // });

  it('should return empty string', async () => {
    jest.spyOn(logger, 'error').mockImplementation();
    const err = 'Error';
    const result = errorHandler.getGasEstimateErrorName(err);
    expect(result).toBe('');
  });
});
